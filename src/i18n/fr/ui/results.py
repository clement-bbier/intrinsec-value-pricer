"""
src/i18n/fr/ui/results.py

RÉFÉRENTIEL DES TEXTES DE RENDU — VERSION INSTITUTIONNELLE FUSIONNÉE (V21)
==========================================================================
Fusion de la version exhaustive V20 et des ancres techniques de l'UI.
"""

class PillarLabels:
    """Labels officiels des 5 piliers de recherche."""
    PILLAR_1_CONF = "1. CONFIGURATION"
    PILLAR_2_TRACE = "2. TRACE MATHÉMATIQUE"
    PILLAR_3_AUDIT = "3. RAPPORT D'AUDIT"
    PILLAR_4_RISK = "4. INGÉNIERIE DU RISQUE"
    PILLAR_5_MARKET = "5. ANALYSE DE MARCHÉ"
    PILLAR_0_SUMMARY = "SYNTHÈSE DÉCISIONNELLE"

class KPITexts:
    """Labels et titres pour l'affichage des résultats (Glass Box)."""

    # --- Navigation & Onglets ---
    VALUE_LABEL = None
    TAB_INPUTS = "Données d'Entrée"
    TAB_CALC = "Preuve de Calcul"
    TAB_AUDIT = "Audit de Fiabilité"
    TAB_MC = "Analyse de Risque (MC)"
    TAB_SCENARIOS = "Analyse de Scénarios"

    # --- NOUVEAU : Synchronisation KPI Cards (Technique) ---
    WACC_LABEL = "WACC (Coût du Capital)"
    KE_LABEL = "Ke (Coût Fonds Propres)"
    GROWTH_G_LABEL = "Croissance Perpétuelle (gn)"
    SBC_ADJUSTMENT_LABEL = "Ajustement Dilution SBC"
    MARGIN_SAFETY_LABEL = "Marge de Sécurité (MoS)"
    MARKET_CAP_LABEL = "Market Cap"
    EQUITY_VALUE_LABEL = "Valeur des Fonds Propres (Equity)"
    INTRINSIC_PRICE_LABEL = "Prix Intrinsèque Estimé"

    # --- Synthèse Décisionnelle (Pillier 0) ---
    EXEC_TITLE = "DOSSIER DE VALORISATION : {name} ({ticker})"
    EXEC_CONFIDENCE = "Indice de Confiance"
    LABEL_PRICE = "Cours de Marché"
    LABEL_IV = "Valeur Intrinsèque"
    LABEL_MOS = "Marge de Sécurité (MoS)"
    LABEL_EXPECTED_VALUE = "Valeur Pondérée (Espérée)"
    LABEL_SIMULATIONS = "Simulations"
    LABEL_SCENARIO_RANGE = "Fourchette Bear - Bull"
    FOOTBALL_FIELD_TITLE = "Synthèse de Triangulation (Football Field)"
    RELATIVE_VAL_DESC = "Positionnement du modèle intrinsèque face aux multiples du secteur."
    LABEL_MULTIPLES_UNAVAILABLE = "Cohorte de comparables insuffisante pour triangulation."

    # --- PILLIER 1 : CONFIGURATION (Hypothèses) ---
    SECTION_INPUTS_HEADER = "#### RÉCAPITULATIF DES DONNÉES UTILISÉES"
    SECTION_INPUTS_CAPTION = "Listing intégral des inputs injectés dans le moteur de calcul."

    SEC_A_IDENTITY = "A. Identification de l'Entreprise"
    LABEL_TICKER = "Ticker"
    LABEL_NAME = "Nom"
    LABEL_SECTOR = "Secteur"
    LABEL_COUNTRY = "Siège Social"
    LABEL_INDUSTRY = "Industrie"
    LABEL_CURRENCY = "Devise"
    LABEL_SHARES = "Actions Diluées"

    SEC_B_FINANCIALS = "B. Données Financières (Source: Yahoo Finance)"
    SUB_MARKET = "Marché & Capitalisation"
    LABEL_MCAP = "Market Cap"
    LABEL_BVPS = "Valeur Comptable / Action"
    SUB_CAPITAL = "Structure du Capital"
    LABEL_DEBT = "Dette Totale"
    LABEL_CASH = "Trésorerie"
    LABEL_NET_DEBT = "Dette Nette"
    LABEL_INTEREST = "Charges d'Intérêts"
    LABEL_MINORITIES = "Intérêts Minoritaires"
    LABEL_PENSIONS = "Provisions Pensions"
    LABEL_NET_BORROWING = "Variation Dette Nette"
    SUB_PERF = "Performance Opérationnelle (TTM)"
    LABEL_REV = "Chiffre d'Affaires"
    LABEL_EBIT = "EBIT"
    LABEL_NI = "Résultat Net"
    LABEL_EPS = "BPA (EPS)"
    SUB_CASH = "Flux de Trésorerie"
    LABEL_FCF_LAST = "Flux de Trésorerie (FCF)"
    LABEL_CAPEX = "CapEx"
    LABEL_DA = "D&A"

    SEC_C_MODEL = "C. Paramètres du Modèle de Valorisation"
    SUB_RATES = "Taux et Primes de Risque"
    LABEL_RF = "Taux Sans Risque (Rf)"
    LABEL_BETA = "Coefficient Bêta (β)"
    LABEL_MRP = "Prime de Risque (MRP)"
    LABEL_KD = "Coût de la Dette (Kd)"
    LABEL_TAX = "Taux d'Imposition"
    SUB_GROWTH = "Croissance et Horizon"
    LABEL_G = "Croissance Phase 1"
    LABEL_GN = "Croissance Perpétuelle (gn)"
    LABEL_HORIZON = "Horizon Explicite"
    LABEL_AAA_YIELD = "Rendement AAA (Graham)"
    LABEL_OMEGA = "Persistance ω (RIM)"
    SUB_CALCULATED = "Métriques de Référence"
    LABEL_WACC = "WACC (Coût du Capital)"
    LABEL_KE = "Ke (Coût Fonds Propres)"
    LABEL_METHOD = "Modèle Utilisé"
    SUB_TV = "Valeur Terminale"
    LABEL_TV_METHOD = "Méthode de Sortie"
    LABEL_EXIT_M = "Multiple de Sortie"
    LABEL_SBC_RATE = "Dilution Annuelle SBC"

    SEC_D_MC = "D. Configuration Monte Carlo"
    LABEL_CORRELATION_BG = "Corrélation (Bêta, g)"
    LABEL_HORIZON_SUB = "Horizon : {years} ans"

    SEC_E_RELATIVE = "E. Valorisation Relative (Secteur)"
    LABEL_FOOTBALL_FIELD_IV = "Modèle Intrinsèque"
    LABEL_FOOTBALL_FIELD_PE = "Multiple P/E"
    LABEL_FOOTBALL_FIELD_EBITDA = "Multiple EV/EBITDA"
    LABEL_FOOTBALL_FIELD_REV = "Multiple EV/Revenue"
    LABEL_FOOTBALL_FIELD_PRICE = "Prix de Marché"

    # --- PILLIER 2 : TRACE MATHÉMATIQUE (Glass Box) ---
    STEP_LABEL = r"Étape {index}"
    FORMULA_THEORY = "Formule Théorique"
    FORMULA_DATA_SOURCE = "*Donnée Source Directe*"
    APP_NUMERIC = "Application Numérique"
    VALUE_UNIT = r"Valeur ({unit})"
    STEP_VALIDATED = "**Vérifié**"
    NOTE_ANALYSIS = "Note d'Analyse"

    # --- Substitutions Glass Box (Strategies) ---
    SUB_FCF_BASE = r"FCF_0 = {val:,.2f} ({src})"
    SUB_FCF_NORM = r"FCF_norm = {val:,.2f} ({src})"
    SUB_REV_BASE = r"Rev_0 = {val:,.0f}"
    SUB_MARGIN_CONV = r"Marge : {curr:.2%} -> {target:.2%} ({years} ans)"
    SUB_EPS_GRAHAM = r"EPS = {val:.2f} ({src})"
    SUB_GRAHAM_MULT = r"Facteur : 8.5 + 2 x {g:.2f}"
    SUB_BV_BASE = r"BV_0 = {val:,.2f} ({src})"
    SUB_SUM_RI = r"Cumul PV(RI) = {val:,.2f}"
    SUB_RIM_TV = r"Sortie : {sub_tv} x {factor:.4f}"
    SUB_RIM_FINAL = r"P = {bv:,.2f} + {ri:,.2f} + {tv:,.2f}"
    SUB_P50_VAL = r"P50 = {val:,.2f} {curr}"
    SUB_FCFE_CALC = r"FCFE = FCFF - Int(1-t) + ΔDette = {val:,.2f}"
    SUB_FCFE_WALK = r"FCFE Walk : NI({ni:,.0f}) + Adj({adj:,.0f}) + ΔDebt({nb:,.0f}) = {total:,.2f}"
    SUB_DDM_BASE = r"D_0 = {val:,.2f} / action"
    SUB_KE_LABEL = r"k_e = {rf:.2%} + {beta:.2f}({mrp:.2%}) = {val:.2%}"
    SUB_EQUITY_NPV = r"Equity NPV = {val:,.2f}"
    SUB_PAYOUT = r"Payout = Div({div:,.2f}) / EPS({eps:,.2f}) = {total:.1%}"
    SUB_TV_PE = r"TV_n = NI_n({ni:,.0f}) x P/E({pe:.1f}x) = {total:,.2f}"
    SUB_HAMADA = "Bêta réendetté (Hamada) selon structure cible."
    SUB_SBC_DILUTION = r"Actions_{{t}} = Actions_{{0}} \times (1 + {rate:.1%})^{years}"

    # --- Tooltips Techniques ---
    HELP_IV = "Valeur intrinsèque : prix théorique après actualisation des flux futurs."
    HELP_MOS = "Marge de sécurité : écart entre la valeur intrinsèque et le prix actuel."
    HELP_KE = "Coût de l'Equity : rendement minimal exigé par les actionnaires (CAPM)."
    HELP_WACC = "Coût moyen pondéré du capital (Dette + Equity)."
    HELP_VAR = "Value-at-Risk : perte maximale possible dans 95% des scénarios simulés."
    HELP_OMEGA = "Coefficient de persistance des profits anormaux (0 = érosion immédiate)."

class AuditTexts:
    """Textes Pillar 3 — Audit & Fiabilité."""
    NO_REPORT = "Audit indisponible pour ce modèle."
    GLOBAL_SCORE = "Indice de Confiance Global : {score:.1f}%"
    RATING_SCORE = "Notation Qualité"
    COVERAGE = "Couverture des Invariants"
    CHECK_TABLE = "Vérification des Règles Normatives"
    H_INDICATOR = "MÉTRIQUE"
    H_RULE = "RÈGLE"
    H_EVIDENCE = "PREUVE"
    H_VERDICT = "VERDICT"
    STATUS_ALERT = "Anomalie"
    STATUS_OK = "Conforme"
    AUDIT_NOTES_EXPANDER = "Détail de l'audit technique"
    LBL_SOTP_REVENUE_CHECK = "Cohérence Revenus SOTP"
    LBL_SOTP_DISCOUNT_CHECK = "Prudence Décote Holding"

class QuantTexts:
    """Textes Pillar 4 — Ingénierie du Risque."""
    BACKTEST_INTERPRETATION = "Un faible gap indique une forte corrélation historique entre les fondamentaux et le prix."
    MC_TITLE = "#### SIMULATION MONTE CARLO"
    MC_FAILED = "Convergence impossible : volatilités trop élevées."
    MC_DOWNSIDE = "Risque de Survalorisation"
    MC_MEDIAN = "Valeur Centrale (P50)"
    MC_VAR = "Value-at-Risk (95%)"
    MC_TAIL_RISK = "Risque de Queue (P5)"
    MC_AUDIT_STOCH = "Audit des Paramètres Stochastiques"
    MC_CONFIG_SUB = r"Sims : {sims} | β Vol: {sig_b:.1%} | g Vol: {sig_g:.1%} | ρ: {rho:.2f}"
    MC_FILTER_SUB = r"{valid} valides / {total} itérations"

    SCENARIO_TITLE = "#### ANALYSE DES SCÉNARIOS STRATÉGIQUES"
    METRIC_WEIGHTED_VALUE = "Valeur Pondérée"
    METRIC_WEIGHTED_UPSIDE = "Potentiel Pondéré"
    COL_SCENARIO = "SCÉNARIO"
    COL_PROBABILITY = "PROBABILITÉ"
    COL_GROWTH = "CROISSANCE"
    COL_MARGIN_FCF = "MARGE"
    COL_VALUE_PER_SHARE = "VALEUR"
    COL_UPSIDE = "UPSIDE"

    BACKTEST_TITLE = "#### PERFORMANCE HISTORIQUE DU MODÈLE"
    LABEL_HIT_RATE = "Taux de Succès (Hit Rate)"
    LABEL_MAE = "Erreur Moyenne (MAE)"

class MarketTexts:
    """Textes Pillar 5 — Analyse de Marché."""
    MARKET_TITLE = "#### VALORISATION RELATIVE SECTORIELLE"
    COL_PEER = "COMPARABLE"
    COL_MULTIPLE = "MULTIPLE"
    COL_IMPLIED_VALUE = "VALEUR IMPLICITE"

    TITLE_SEGMENTATION = "#### DÉCOMPOSITION SOTP"
    CAPTION_SEGMENTATION = "Répartition de la valeur d'entreprise par segments opérationnels."
    COL_SEGMENT = "UNITÉ COMMERCIALE"
    COL_VALUE = "VALEUR"
    COL_CONTRIBUTION = "CONTRIBUTION (%)"
    METRIC_GROSS_VALUE = "Valeur Brute (Somme)"
    METRIC_HOLDING_DISCOUNT = "Décote de Holding"
    METRIC_NET_VALUE = "Valeur Nette"

class ChartTexts:
    """Libellés pour graphiques Plotly/Altair."""
    PRICE_HISTORY_TITLE = "Historique : {ticker}"
    SIM_AXIS_X = "Valeur par Action ({currency})"
    SIM_AXIS_Y = "Densité de Probabilité"
    SENS_TITLE = "Sensibilité WACC / Croissance"
    CORREL_CAPTION = "Matrice de Corrélation des Inputs"

class PDFTexts:
    """Pitchbook PDF."""
    PAGE_EXECUTIVE_SUMMARY = "RESEARCH REPORT - INTRINSIC VALUE"
    SECTION_VALORISATION = "SYNTHÈSE DE VALORISATION"
    LABEL_RECOMMENDATION = "AVIS ANALYSTE"
    FOOTER_GENERATED_BY = "Intrinsic Value Pricer | {date} | v{version}"